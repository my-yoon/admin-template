{"remainingRequest":"/Users/zzou/Documents/project/2020/brabbit-admin-template/node_modules/babel-loader/lib/index.js!/Users/zzou/Documents/project/2020/brabbit-admin-template/node_modules/ts-loader/index.js??ref--13-2!/Users/zzou/Documents/project/2020/brabbit-admin-template/src/helper/api/index.ts","dependencies":[{"path":"/Users/zzou/Documents/project/2020/brabbit-admin-template/src/helper/api/index.ts","mtime":1591668793119},{"path":"/Users/zzou/Documents/project/2020/brabbit-admin-template/node_modules/cache-loader/dist/cjs.js","mtime":1582363961748},{"path":"/Users/zzou/Documents/project/2020/brabbit-admin-template/node_modules/babel-loader/lib/index.js","mtime":1585275399303},{"path":"/Users/zzou/Documents/project/2020/brabbit-admin-template/node_modules/ts-loader/index.js","mtime":1585276838680}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy96em91L0RvY3VtZW50cy9wcm9qZWN0LzIwMjAvYnJhYmJpdC1hZG1pbi10ZW1wbGF0ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL3p6b3UvRG9jdW1lbnRzL3Byb2plY3QvMjAyMC9icmFiYml0LWFkbWluLXRlbXBsYXRlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBBdXRoIGZyb20gJy4vMS4wLjAvQXV0aCc7CmltcG9ydCBPcmRlciBmcm9tICcuLzEuMC4wL09yZGVyJzsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgYXV0aGVudGljYXRpb24gZnJvbSAnLi4vYXV0aGVudGljYXRpb24nOwpleHBvcnQgdmFyIEFwaSA9IGZ1bmN0aW9uIEFwaSgpIHsKICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXBpKTsKCiAgdGhpcy50cmFuc2l0aW9uID0gZmFsc2U7CiAgLyoqCiAgICog7JqU7LKtIOyghAogICAqLwoKICB0aGlzLnJlcXVlc3RJbnRlcmNlcHRvciA9IGZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgICBpZiAoVnVlLnByb3RvdHlwZS4kTG9jYWxTdG9yYWdlLmlzRXhpc3RzVG9rZW4oKSkgewogICAgICByZXF1ZXN0LmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICJCZWFyZXIgIi5jb25jYXQoVnVlLnByb3RvdHlwZS4kTG9jYWxTdG9yYWdlLmF1dGhUb2tlbigpKTsKICAgIH0gZWxzZSB7CiAgICAgIFZ1ZS4kbG9nLmRlYnVnKCcjIG5vdCBmb3VuZCB0b2tlbicpOwogICAgfQoKICAgIHJldHVybiByZXF1ZXN0OwogIH07CiAgLyoqCiAgICog7KCV7IOB7J2R64u1CiAgICoKICAgKi8KCgogIHRoaXMucmVzcG9uc2VJbnRlcmNlcHRvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXNwb25zZSkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzcG9uc2UpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKTsKICAvKioKICAgKiDsmKTrpZjsnZHri7UKICAgKi8KCgogIHRoaXMucmVzcG9uc2VFcnJvckludGVyY2VwdG9yID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoZXJyb3IpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpZiAoIShlcnJvci5zdGF0dXMgPT09IDQwMSAmJiBlcnJvci5yZXRyeSA9PT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBlcnJvci5yZXRyeSA9IHRydWU7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBhdXRoZW50aWNhdGlvbi5sb2dpbldpdGhSZWZyZXNoVG9rZW4oZnVuY3Rpb24gKGlzU3VjY2VzcywgcmVzKSB7CiAgICAgICAgICAgICAgICBpZiAoaXNTdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgIGVycm9yLmNvbmZpZy5oZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAiQmVhcmVyICIuY29uY2F0KFZ1ZS5wcm90b3R5cGUuJExvY2FsU3RvcmFnZS5hdXRoVG9rZW4oKSk7CiAgICAgICAgICAgICAgICAgIHJldHVybiBheGlvcyhlcnJvci5jb25maWcpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZWplY3QoZXJyb3IpKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyKTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpOwoKICB0aGlzLmJpekF4aW9zID0gYXhpb3MuY3JlYXRlKCk7CiAgdGhpcy5iaXpBeGlvcy5kZWZhdWx0cy5iYXNlVVJMID0gcHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElfU0VSVkVSOyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICB0aGlzLmJpekF4aW9zLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UodGhpcy5yZXNwb25zZUludGVyY2VwdG9yKTsKICB0aGlzLmJpekF4aW9zLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZSh0aGlzLnJlcXVlc3RJbnRlcmNlcHRvciwgdGhpcy5yZXNwb25zZUVycm9ySW50ZXJjZXB0b3IpOyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICB0aGlzLmF1dGggPSBuZXcgQXV0aCh0aGlzLmJpekF4aW9zKTsKICB0aGlzLm9yZGVyID0gbmV3IE9yZGVyKHRoaXMuYml6QXhpb3MpOwp9OwpleHBvcnQgZGVmYXVsdCBuZXcgQXBpKCk7"},{"version":3,"sources":["/Users/zzou/Documents/project/2020/brabbit-admin-template/src/helper/api/index.ts"],"names":[],"mappings":";;;;AAAA,OAAO,KAAP,MAAoD,OAApD;AACA,OAAO,IAAP,MAAiB,cAAjB;AACA,OAAO,KAAP,MAAkB,eAAlB;AACA,OAAO,GAAP,MAAgB,KAAhB;AACA,OAAO,cAAP,MAA2B,mBAA3B;AAEA,WAAa,GAAb,GAOE,eAAA;AAAA;;AALQ,OAAA,UAAA,GAAsB,KAAtB;AAiBR;;;;AAGA,OAAA,kBAAA,GAAqB,UAAC,OAAD,EAAiB;AACpC,QAAI,GAAG,CAAC,SAAJ,CAAc,aAAd,CAA4B,aAA5B,EAAJ,EAAiD;AAC/C,MAAA,OAAO,CAAC,OAAR,CAAgB,eAAhB,qBAA6C,GAAG,CAAC,SAAJ,CAAc,aAAd,CAA4B,SAA5B,EAA7C;AACD,KAFD,MAEO;AACL,MAAA,GAAG,CAAC,IAAJ,CAAS,KAAT,CAAe,mBAAf;AACD;;AACD,WAAO,OAAP;AACD,GAPD;AASA;;;;;;AAIA,OAAA,mBAAA;AAAA,uEAAsB,iBAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA,+CACb,QADa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAtB;;AAAA;AAAA;AAAA;AAAA;AAGA;;;;;AAGA,OAAA,wBAAA;AAAA,wEAA2B,kBAAO,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA,oBAErB,KAAK,CAAC,MAAN,KAAiB,GAAjB,IAAwB,KAAK,CAAC,KAAN,KAAgB,SAFnB;AAAA;AAAA;AAAA;;AAGvB,cAAA,KAAK,CAAC,KAAN,GAAc,IAAd;AAHuB;AAAA,qBAIjB,cAAc,CAAC,qBAAf,CAAqC,UAAC,SAAD,EAAiB,GAAjB,EAA6B;AACtE,oBAAI,SAAJ,EAAe;AACb,kBAAA,KAAK,CAAC,MAAN,CAAa,OAAb,CAAqB,eAArB,qBAAkD,GAAG,CAAC,SAAJ,CAAc,aAAd,CAA4B,SAA5B,EAAlD;AACA,yBAAO,KAAK,CAAC,KAAK,CAAC,MAAP,CAAZ;AACD,iBAHD,MAGO;AACL,yBAAO,OAAO,CAAC,MAAR,CAAe,KAAf,CAAP;AACD;AACF,eAPK,CAJiB;;AAAA;AAAA,gDAalB,OAAO,CAAC,MAAR,CAAe,KAAf,CAbkB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA3B;;AAAA;AAAA;AAAA;AAAA;;AAjCE,OAAK,QAAL,GAAgB,KAAK,CAAC,MAAN,EAAhB;AACA,OAAK,QAAL,CAAc,QAAd,CAAuB,OAAvB,GAAiC,OAAO,CAAC,GAAR,CAAY,kBAA7C,CAFF,CAGE;;AACA,OAAK,QAAL,CAAc,YAAd,CAA2B,QAA3B,CAAoC,GAApC,CAAwC,KAAK,mBAA7C;AACA,OAAK,QAAL,CAAc,YAAd,CAA2B,OAA3B,CAAmC,GAAnC,CAAuC,KAAK,kBAA5C,EAAgE,KAAK,wBAArE,EALF,CAOE;;AACA,OAAK,IAAL,GAAY,IAAI,IAAJ,CAAS,KAAK,QAAd,CAAZ;AACA,OAAK,KAAL,GAAa,IAAI,KAAJ,CAAU,KAAK,QAAf,CAAb;AACD,CAjBH;AAyDA,eAAe,IAAI,GAAJ,EAAf","sourcesContent":["import axios, { AxiosInstance, AxiosResponse } from 'axios'\nimport Auth from './1.0.0/Auth'\nimport Order from './1.0.0/Order'\nimport Vue from 'vue'\nimport authentication from '../authentication'\n\nexport class Api {\n  private bizAxios: AxiosInstance\n  private transition: boolean = false\n  // ---------------------\n  auth: Auth\n  order: Order\n\n  constructor () {\n    this.bizAxios = axios.create()\n    this.bizAxios.defaults.baseURL = process.env.VUE_APP_API_SERVER\n    // --------------------------------\n    this.bizAxios.interceptors.response.use(this.responseInterceptor)\n    this.bizAxios.interceptors.request.use(this.requestInterceptor, this.responseErrorInterceptor)\n\n    // --------------------------------\n    this.auth = new Auth(this.bizAxios)\n    this.order = new Order(this.bizAxios)\n  }\n\n  /**\n   * 요청 전\n   */\n  requestInterceptor = (request: any) => {\n    if (Vue.prototype.$LocalStorage.isExistsToken()) {\n      request.headers['Authorization'] = `Bearer ${Vue.prototype.$LocalStorage.authToken()}`\n    } else {\n      Vue.$log.debug('# not found token')\n    }\n    return request\n  }\n\n  /**\n   * 정상응답\n   *\n   */\n  responseInterceptor = async (response: any) => {\n    return response\n  }\n  /**\n   * 오류응답\n   */\n  responseErrorInterceptor = async (error: any) => {\n    // -- 권한 관련 오류인 경우\n    if (error.status === 401 && error.retry === undefined) {\n      error.retry = true\n      await authentication.loginWithRefreshToken((isSuccess: any, res: any) => {\n        if (isSuccess) {\n          error.config.headers['Authorization'] = `Bearer ${Vue.prototype.$LocalStorage.authToken()}`\n          return axios(error.config)\n        } else {\n          return Promise.reject(error)\n        }\n      })\n    }\n    return Promise.reject(error)\n  }\n}\nexport default new Api()\n"],"sourceRoot":""}]}